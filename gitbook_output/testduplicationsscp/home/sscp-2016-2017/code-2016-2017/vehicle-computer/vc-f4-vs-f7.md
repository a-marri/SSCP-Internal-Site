# SSCP - VC: F4 vs F7

# VC: F4 vs F7

* April 10: I've been doing some benchmarking and it turns out the amount of RAM used for flashing is actually 128kB on the f4 rather than the full 1 MB, and our compiled code is 144kB, so we're just a bit too large. I'm guessing the ratio will be similar with the f7, so we should be fine. That said, it might be possible to decrease the size of our code by 16 kB? I'm working on it and have gotten it down by about 0.5 kB....so it doesn't look super likely. But it does seem kind of crazy to me that our code would be 16kB over with just the addition of ethernet libraries VC code without ethernet is 116kB and ethernet-only IAR project is 39kB, so it definitely seems like we should focus on cleaning the fat from the ethernet implementation (the reason those don't sum to 144 is that there is some overlap, like other basic drivers, the main function, etc), and obviously FreeRTOSApril 12: Discovered that FreeRTOS was allocating 96kb for itself, which is way more than necessary (per documentation here). Changed that to 64kb and it flashes!TBD: Get 2015 IMU board functional. Flash and modify code to populate dummy CAN and ethernet messages. Check that both can be simultaneously sent.Debugging tools: in IAR, go to tools > options > messages > Show build messages and select "all". This will print out compiled code size, RAM size (marked DATA), and const size for each file and also overall.
* April 10: I've been doing some benchmarking and it turns out the amount of RAM used for flashing is actually 128kB on the f4 rather than the full 1 MB, and our compiled code is 144kB, so we're just a bit too large. I'm guessing the ratio will be similar with the f7, so we should be fine. That said, it might be possible to decrease the size of our code by 16 kB? I'm working on it and have gotten it down by about 0.5 kB....so it doesn't look super likely. But it does seem kind of crazy to me that our code would be 16kB over with just the addition of ethernet libraries VC code without ethernet is 116kB and ethernet-only IAR project is 39kB, so it definitely seems like we should focus on cleaning the fat from the ethernet implementation (the reason those don't sum to 144 is that there is some overlap, like other basic drivers, the main function, etc), and obviously FreeRTOS
* April 12: Discovered that FreeRTOS was allocating 96kb for itself, which is way more than necessary (per documentation here). Changed that to 64kb and it flashes!
* TBD: Get 2015 IMU board functional. Flash and modify code to populate dummy CAN and ethernet messages. Check that both can be simultaneously sent.
* Debugging tools: in IAR, go to tools > options > messages > Show build messages and select "all". This will print out compiled code size, RAM size (marked DATA), and const size for each file and also overall.

* April 10: I've been doing some benchmarking and it turns out the amount of RAM used for flashing is actually 128kB on the f4 rather than the full 1 MB, and our compiled code is 144kB, so we're just a bit too large. I'm guessing the ratio will be similar with the f7, so we should be fine. That said, it might be possible to decrease the size of our code by 16 kB? I'm working on it and have gotten it down by about 0.5 kB....so it doesn't look super likely. But it does seem kind of crazy to me that our code would be 16kB over with just the addition of ethernet libraries VC code without ethernet is 116kB and ethernet-only IAR project is 39kB, so it definitely seems like we should focus on cleaning the fat from the ethernet implementation (the reason those don't sum to 144 is that there is some overlap, like other basic drivers, the main function, etc), and obviously FreeRTOS
* April 12: Discovered that FreeRTOS was allocating 96kb for itself, which is way more than necessary (per documentation here). Changed that to 64kb and it flashes!
* TBD: Get 2015 IMU board functional. Flash and modify code to populate dummy CAN and ethernet messages. Check that both can be simultaneously sent.
* Debugging tools: in IAR, go to tools > options > messages > Show build messages and select "all". This will print out compiled code size, RAM size (marked DATA), and const size for each file and also overall.

April 10: I've been doing some benchmarking and it turns out the amount of RAM used for flashing is actually 128kB on the f4 rather than the full 1 MB, and our compiled code is 144kB, so we're just a bit too large. I'm guessing the ratio will be similar with the f7, so we should be fine. That said, it might be possible to decrease the size of our code by 16 kB? I'm working on it and have gotten it down by about 0.5 kB....so it doesn't look super likely. But it does seem kind of crazy to me that our code would be 16kB over with just the addition of ethernet libraries VC code without ethernet is 116kB and ethernet-only IAR project is 39kB, so it definitely seems like we should focus on cleaning the fat from the ethernet implementation (the reason those don't sum to 144 is that there is some overlap, like other basic drivers, the main function, etc), and obviously FreeRTOS

April 12: Discovered that FreeRTOS was allocating 96kb for itself, which is way more than necessary (per documentation here). Changed that to 64kb and it flashes!

[ documentation here](/stanford.edu/testduplicationsscp/home/sscp-2014-2015/code-2014-2015/reading-list/freertos)

TBD: Get 2015 IMU board functional. Flash and modify code to populate dummy CAN and ethernet messages. Check that both can be simultaneously sent.

Debugging tools: in IAR, go to tools > options > messages > Show build messages and select "all". This will print out compiled code size, RAM size (marked DATA), and const size for each file and also overall.

