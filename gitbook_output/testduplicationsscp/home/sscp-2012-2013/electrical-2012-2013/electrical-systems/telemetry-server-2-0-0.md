# telemetry-server-2-0-0

## SSCP - Telemetry Server 2-0-0

## Telemetry Server 2-0-0

Telemetry Box/Telemetry Server Overview:

After the telemetry antics of the 2011 race, a decision was made to make the telemetry system Wifi-based. The hopes were high: the car would both store its own data and host an easy-to-use webpage would enable anyone with a Wifi-enabled device to easily access said data via a live view, historical graphs, color-coded health indicators, and the like. To this end several team members devoted class projects to developing the software backend (known as Dandelion).

As testing in the central valley proceeded, it became clear that the Wifi signal wasn’t strong enough to punch its way through the car’s carbon fiber faraday cage and its contained EMI, and that running a custom webpage kept the processor’s power consumption at too high of a level. However, since we didn’t plan early enough for a more elegant implementation of a rear-view system (the system we implemented as a last-minute backup in Australia consisted of two small cameras wired directly to two LCD screens taped to the top of the battery back and powered by a COTS power converter) we stuck with the telemetry box we’d already created. This box only barely worked for the rear-view functionality: It had to be mounted in a position that was difficult for the driver to see, and because we tried to minimize airflow in the body for aerodynamic reasons, it was difficult to dissipate the heat generated by the processor, even when the processor was thermally connected to its machined aluminum case. The processor heated up dramatically, forcing it into a constant reboot loop. This reboot loop was also unfortunately the processor’s highest-power state (since the various power-saving functionality in the Kernel didn’t have time to activate, nor did it have time to disable the screen’s backlight), exacerbating the problem and consuming almost 9 watts quiescent throughout the entire race.&#x20;

&#x20;

Hardware Details:

The Telemetry Server is based on a SO-DIMM Form Factor System On Module (SOM). This module, made by Boundary Devices, houses a Cortex A9 running at 1 GHz and 1 GB of RAM. It was primarily chosen for its computing power, ability to run Linux immediately, relative ease of integration (to be discussed), and perhaps most importantly a hardware CAN peripheral with Linux networking drivers. The form factor allows it to plug into a custom carrier board that powers it and connects it to the outside world by means of (most notably) two SDIO channels (one for an actual SD card that holds the boot and storage file systems, and another to interface with a Wifi Interface chip), a multichannel LVDS bus (to interface with an LCD), a host-only USB port (for connecting a USB webcam), an external-facing I2C peripheral (to potentially interface with a touchscreen or other external peripherals) and CAN.

&#x20;           The carrier board broke out the aforementioned peripherals and provided the connection to the rest of the system. There were three external-facing connectors when the board was in operation. Our standard 5-pin CAN and 24V Phoenix connector powered the board and connected it to the CAN bus. Additionally, the rear-mounted webcam plugged in via a USB-A Female connector and an external Wifi antenna plugged in via an RP-SMA connector. For debugging purposes, there was also a female USB-MicroB connector connected to an FTDI USB-Serial chip and run to the SOM’s Serial Console Debug UART.

&#x20;           Telemetry Server Rev 1:

To supply power to the System On Module, SD Card, and LCD Screen, a multi-stage power supply design was used. Initially, two buck converters were used. The first, an LT3690? 4A synchronous buck converter was used to supply the 5V@1A necessary to run the SOM. The second was an early version of the 3.3V Medium Power Module to run everything else (SD card, RF section of the Wifi module, and had we gotten that far the LCD screen). An additional 1.8V LDO was powered from the 3.3V rail and used to power the Wifi Module’s I/O. Unfortunately, said early medium power module was unreliable and noisy, and additionally had relatively poor transient response at SD card/Wifi module speeds, with the amount of low ESR capacitance being added probably not helping with the stability problem. As such it was highly unreliable and prone to exploding SD Cards. Additionally, since we had gotten a bleeding edge unreleased SOM, there were certain bugs that Boundary hadn’t noticed in time for the first revision of the board. Of primary concern was the lack of card-edge route-out of the 32.768Khz Slow Clock necessary to run the Wifi module and the need for a yellow-wire jump aboard the module itself. Compounding on these failures, I also made the classic error of swapping RX and TX lines between the Serial Debug Console and its USB-Serial chip, rendering the chip deaf and mute. All in all, a poor showing by me and Boundary alike, and an omen for the future. In an attempt to prove some section of the design during the first board’s bring-up, I replaced the 3.3V power module with another line of Xantrex bench power supply, yellow-wired the RX and TX lines to their proper locations, and constructed a monstrous dead-bug-style 32Khz clock source from a clock crystal, a DIP inverter, and a variety of passives. This set of hacks allowed bring-up to the point where (to my recollection) we could just barely verify that the various parts worked together. However, a new revision of the board was clearly needed.

&#x20;

Telemetry Server Rev 2:

The second revision of the board attempted to remedy the fails of the first using several methods. The 3.3V power module was removed and replaced with a 3.3V LDO powered by the 5V buck regulator (the only part left unchanged, as it had worked perfectly). This LDO was selected for its transient response and was carefully decoupled both locally and at each draw point (SD card, Wifi module, LCD Screen). The 1.8V LDO was also powered from the 5V bus. The hacky dead-bug crystal driver was replaced with an off-the-shelf TTL-level oscillator module, and the TX/RX lines of the serial console were properly connected.

During layout I also swapped from 2 layers to 4, giving me dedicated power, ground, and signal planes, and allowing me to move the high-speed components (the Wifi module, SD card, and SO-DIMM connector) closer together, shortening the trace lengths between them and possibly improving their reliability.

With these changes made the revised board was brought up successfully and on-board development was able to start. Unfortunately, the end result was still an overheating and unreliable system that failed as a telemetry system and only barely got us through scrutineering as a rear-view system.&#x20;

#### Embedded Google Drive File

Google Drive File: [Embedded Content](https://drive.google.com/embeddedfolderview?id=11CGjYIg1MBE7wc1ViWANipn1IbiQAGbi#list)
